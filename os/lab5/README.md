# 虚拟内存页面置换算法模拟

20232241392-文浩然-软 2305

## 实验内容

本实验实现了 6 种经典的页面置换算法，并提供了性能比较功能：

### 已实现的算法

1. **LRU (Least Recently Used)** - 最近最少使用算法
2. **FIFO (First In First Out)** - 先进先出算法
3. **CLOCK** - 时钟(二次机会)置换算法
4. **Enhanced CLOCK** - 增强二次机会置换算法
5. **LFU (Least Frequently Used)** - 最不经常使用算法
6. **MFU (Most Frequently Used)** - 最经常使用算法

### 新增功能

#### 1. 多样化的输入方式

- **手动输入**：用户自定义页面引用串
- **Belady 测试序列**：使用经典测试序列 `7 0 1 2 0 3 0 4 2 3 0 3 2 1 2 0 1 7 0 1`
- **随机生成**：根据指定范围随机生成页面引用串

#### 2. 算法性能比较

- 自动运行所有 6 种算法
- 统计各算法的缺页次数和缺页率
- 生成性能对比表格

#### 3. 增强的算法实现

**Enhanced CLOCK 算法**：

- 使用引用位和修改位两个标志
- 四阶段优先级扫描：(0,0) → (0,1) → (1,0) → (1,1)
- 模拟写操作，30%概率标记页面为已修改

**LFU/MFU 算法**：

- 维护页面访问频率计数
- 根据访问频率选择替换页面

## 项目结构改进

### 1. Makefile 优化

```makefile
# 将编译产物统一管理到bin目录
BINDIR=bin
objs=$(BINDIR)/vmrp.o

# 目标文件和可执行文件都放在bin目录中
$(BINDIR)/vmrp.o: $(srcs) $(head) | $(BINDIR)
	g++ $(opts) $(srcs) -o $(BINDIR)/vmrp.o
```

**改进点**：

- 所有编译产物（.o 文件和可执行文件）统一放在`bin/`目录
- 便于项目管理和清理
- 避免源码目录混乱

### 2. 版本控制优化

创建`.gitignore`文件，忽略编译产物：

```
bin/
*.o
*.exe
```

### 3. 代码架构改进

- 使用小驼峰命名规范
- 类职责单一，专注于页面置换算法实现
- 模块化设计，便于扩展新算法

## 编译和运行

### 编译

```bash
make
```

### 运行

```bash
./bin/vmrp
```

### 清理

```bash
make clean
```

## 使用示例

### 1. 选择输入模式

```
请选择输入模式：
1 - 手动输入页面引用串
2 - 使用Belady测试序列
3 - 随机生成页面引用串
请选择（1-3）：2
```

### 2. 设置参数

```
请输入页面数量：20
使用Belady测试序列：7 0 1 2 0 3 0 4 2 3 0 3 2 1 2 0 1 7 0 1
请输入内存帧数：3
```

### 3. 查看结果

程序会自动运行所有算法并显示性能比较：

```
========== 性能比较结果 ==========
算法名称         缺页次数    缺页率(%)
----------------------------------------
LRU             15        75.00%
FIFO            15        75.00%
CLOCK           15        75.00%
Enhanced CLOCK  14        70.00%
LFU             16        80.00%
MFU             17        85.00%
```

## 算法分析

### 性能特点

1. **LRU 算法**：理论最优，但实现复杂度高
2. **FIFO 算法**：实现简单，但可能出现 Belady 异常
3. **CLOCK 算法**：LRU 的近似实现，性能接近 LRU
4. **Enhanced CLOCK**：考虑页面修改，减少磁盘 I/O
5. **LFU 算法**：适合访问模式稳定的场景
6. **MFU 算法**：在特定访问模式下有效

### 影响因素

- **内存帧数**：帧数越多，缺页率越低
- **页面访问模式**：局部性好的访问模式有利于 LRU 类算法
- **页面修改频率**：影响 Enhanced CLOCK 的性能
